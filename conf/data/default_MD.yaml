# train_max_epochs: 20
train_max_iter: 4000 # step
early_stopping_patience: 1000

num_workers: 0 # Should be 0 or it takes too much time / Stupid Lightning bug
pin_memory: True
batch_size: 32

pdir: /home/holywater2/crystal

type: small_density
root: ${data.pdir}/dataset
mol_name: benzene

atom_file: ${data.pdir}/GPWNO/atom_info/md.json
# model:
#   type: infgcn
#   n_atom_type: 3
#   num_radial: 16
#   num_spherical: 7
#   radial_embed_size: 64
#   radial_hidden_size: 128
#   num_radial_layer: 2
#   num_gcn_layer: 3
#   cutoff: 3.
#   grid_cutoff: 3.
#   is_fc: false
#   gauss_start: 0.5
#   gauss_end: 5.


datamodule:
  _target_: source.datamodule.datamodule.CrystalDatamodule
  collate_fn: 
    _target_: source.datasets.collator.DensityCollator

  datasets:
    train:
      _target_: source.datasets.small_density.SmallDensityDataset
      split : train
      n_samples: 1024
      shuffle: true
      type: ${data.type}
      root: ${data.root}
      mol_name: ${data.mol_name}
  

    val:
      _target_: source.datasets.small_density.SmallDensityDataset
      split : validation
      n_samples: 2048
      shuffle: False
      type: ${data.type}
      root: ${data.root}
      mol_name: ${data.mol_name}


    test:
      _target_: source.datasets.small_density.SmallDensityDataset
      split : test
      n_samples: Null
      shuffle: False
      type: ${data.type}
      root: ${data.root}
      mol_name: ${data.mol_name}

  num_workers:
    train: ${data.num_workers}
    val: ${data.num_workers}
    test: ${data.num_workers}

  batch_size:
    train: ${data.batch_size}
    val: ${data.batch_size}
    test: 4